# 研究设计技能 - 依赖管理文档

## 依赖管理策略

本技能使用 `uv` 作为首选依赖管理工具，以确保依赖管理的一致性和效率。

## 核心依赖

### 必需依赖
- `pandas>=1.5.0,<3.0.0`
  - 用途：数据处理和分析
  - 版本范围：确保与Python 3.8+兼容
- `numpy>=1.21.0,<2.0.0`
  - 用途：数值计算
  - 版本范围：确保与pandas兼容

### 可选依赖 (开发用)
- `pytest>=7.0.0`
  - 用途：测试框架
- `black>=22.0.0`
  - 用途：代码格式化
- `mypy>=0.950`
  - 用途：类型检查

## 依赖管理命令

### 安装依赖
```bash
# 安装所有依赖（包括可选依赖）
uv sync

# 仅安装运行时依赖
uv sync --no-dev

# 安装特定依赖
uv add package_name
```

### 更新依赖
```bash
# 更新所有依赖到兼容版本
uv sync --upgrade

# 更新特定依赖
uv add --upgrade package_name
```

### 虚拟环境管理
```bash
# 创建虚拟环境
uv venv

# 激活虚拟环境
source .venv/bin/activate  # Unix/macOS
.venv\Scripts\Activate.ps1  # Windows

# 在虚拟环境中运行脚本
uv run python script.py
```

## 依赖策略说明

### 最小依赖原则
我们遵循最小依赖原则，只包含必要的库：
- 使用标准库尽可能多地实现功能
- 仅在需要高级数据处理时才引入pandas和numpy
- 避免不必要的依赖以减少安全风险

### 版本控制
- 使用保守的版本范围（如 `<3.0.0`）
- 定期检查依赖更新
- 确保向前兼容性

### 替代方案考虑
对于每个依赖，我们都考虑了是否有标准库的替代方案：
- pandas/numpy：对于复杂的数据处理和数值计算，标准库无法完全替代
- 因此，这些依赖被认为是必需的

## 依赖验证

所有依赖都经过验证，确保：
- 功能必要性：依赖提供的功能无法通过标准库有效实现
- 安全性：依赖库维护活跃，无已知严重安全漏洞
- 兼容性：与Python 3.8+和其他依赖兼容
- 许可证：符合MIT许可证要求

## 依赖更新策略

- 定期（每月）检查依赖更新
- 在更新前进行完整测试
- 记录更新原因和影响
- 保持版本范围的合理性

## 疑难解答

### 常见问题
1. **依赖冲突**：使用 `uv pip compile` 检查依赖冲突
2. **安装失败**：检查Python版本是否符合要求
3. **版本不兼容**：调整版本范围或更新代码

### 性能优化
- 使用 `.gitignore` 排除不必要的依赖文件
- 定期清理未使用的依赖
- 使用 `--no-dev` 标志在生产环境中安装

## 与 agentskills.io 规范的符合性

我们的依赖管理策略完全符合 agentskills.io 规范：
- 明确定义了必需和可选依赖
- 使用行业标准的依赖管理工具
- 遵循最小依赖原则
- 提供了清晰的安装和使用说明